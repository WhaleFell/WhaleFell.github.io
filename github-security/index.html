<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="renderer" content="webkit"><meta name="force-rendering" content="webkit"><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><meta name="HandheldFriendly" content="True"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><link rel="shortcut icon" href="/images/favicon.ico"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.ico"><link rel="mask-icon" href="/images/favicon.ico"><title>GIT 安全使用指南 | 😊落落のBlog😊</title><meta name="keywords" content="GitHub, Cybersecurity, OpenSourceSecurity, 开源安全, 网络安全, 编程,博客,记录,技术,生活,前端,摄影,LGBT,计算机,网络安全,Life,Cybersecurity,Python,Golang,Vue,Javascript,Java,Linux"><meta name="description" content="Git 安全使用指南每时每刻，网络上成千上万的机器人贪婪的检索 GitHub，这包括开源软件 Attacker, Hacker ,甚至于受国家政府支持的 Attacker。 概述开源供应链攻击（Open source supply chain attack）近年来，供应链攻击事件 不断频发。过去一年中，恶意软件包上传到各种公共包管理库的事件数量呈爆炸式增长，这表明攻击者越来越青睐这种初始访问策略。"><meta property="og:type" content="article"><meta property="og:title" content="GIT 安全使用指南"><meta property="og:url" content="https://www.whaleluo.top/github-security/index.html"><meta property="og:site_name" content="😊落落のBlog😊"><meta property="og:description" content="Git 安全使用指南每时每刻，网络上成千上万的机器人贪婪的检索 GitHub，这包括开源软件 Attacker, Hacker ,甚至于受国家政府支持的 Attacker。 概述开源供应链攻击（Open source supply chain attack）近年来，供应链攻击事件 不断频发。过去一年中，恶意软件包上传到各种公共包管理库的事件数量呈爆炸式增长，这表明攻击者越来越青睐这种初始访问策略。"><meta property="og:locale"><meta property="article:published_time" content="2024-04-03T08:36:23.000Z"><meta property="article:modified_time" content="2024-04-03T08:36:23.000Z"><meta property="article:author" content="WhaleFall"><meta property="article:tag" content="GitHub"><meta property="article:tag" content="Cybersecurity"><meta property="article:tag" content="OpenSourceSecurity"><meta property="article:tag" content="开源安全"><meta property="article:tag" content="网络安全"><meta name="twitter:card" content="images&#x2F;favicon.ico"><link rel="stylesheet" href="/css/style/main.css"><link rel="stylesheet" id="hl-default-theme" href="https://api.whaleluo.top/file/?url=https://cdn.jsdelivr.net/npm/highlight.js@10.1.2/styles/atom-one-light.css" media="none"><link rel="stylesheet" id="hl-dark-theme" href="https://api.whaleluo.top/file/?url=https://cdn.jsdelivr.net/npm/highlight.js@10.1.2/styles/atom-one-dark.css" media="none"><link rel="stylesheet" href="/css/style/dark.css"><script src="/js/darkmode.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests"><meta name="google-site-verification" content="bka9Mdyvo7g1v-jQq8CzqcaY9zE2QGltMwsvO63rAUw"><meta name="generator" content="Hexo 7.1.1"><link rel="alternate" href="/atom.xml" title="😊落落のBlog😊" type="application/atom+xml"></head><body><div id="app" tabindex="-1"><header class="header"><div class="header__left"><a href="/" class="button"><span class="logo__text">落落のBlog</span></a></div><div class="header__right"><div class="navbar__menus"><a href="/" class="navbar-menu button">首页</a> <a href="/tags/" class="navbar-menu button">标签</a> <a href="/archives/" class="navbar-menu button">归档</a> <a href="/categories/" class="navbar-menu button">主题</a> <a href="/friends/" class="navbar-menu button">友链</a> <a href="/about/" class="navbar-menu button">关于</a> <a href="/event/" class="navbar-menu button">大事记</a> <a href="/atom.xml" class="navbar-menu button">RSS</a></div><a href="/search/" id="btn-search"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" width="24" height="24" fill="currentColor" stroke="currentColor" stroke-width="32"><path d="M192 448c0-141.152 114.848-256 256-256s256 114.848 256 256-114.848 256-256 256-256-114.848-256-256z m710.624 409.376l-206.88-206.88A318.784 318.784 0 0 0 768 448c0-176.736-143.264-320-320-320S128 271.264 128 448s143.264 320 320 320a318.784 318.784 0 0 0 202.496-72.256l206.88 206.88 45.248-45.248z"></path></svg> </a><a href="javaScript:void(0);" id="btn-toggle-dark"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg> </a><a class="dropdown-icon button" id="btn-dropdown" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="24" height="24" fill="none" stroke="currentColor" stroke-width="0.7" stroke-linecap="round" stroke-linejoin="round"><path fill="currentColor" d="M3.314,4.8h13.372c0.41,0,0.743-0.333,0.743-0.743c0-0.41-0.333-0.743-0.743-0.743H3.314c-0.41,0-0.743,0.333-0.743,0.743C2.571,4.467,2.904,4.8,3.314,4.8z M16.686,15.2H3.314c-0.41,0-0.743,0.333-0.743,0.743s0.333,0.743,0.743,0.743h13.372c0.41,0,0.743-0.333,0.743-0.743S17.096,15.2,16.686,15.2z M16.686,9.257H3.314c-0.41,0-0.743,0.333-0.743,0.743s0.333,0.743,0.743,0.743h13.372c0.41,0,0.743-0.333,0.743-0.743S17.096,9.257,16.686,9.257z"></path></svg></a><div class="dropdown-menus" id="dropdown-menus"><a href="/" class="dropdown-menu button">首页</a> <a href="/tags/" class="dropdown-menu button">标签</a> <a href="/archives/" class="dropdown-menu button">归档</a> <a href="/categories/" class="dropdown-menu button">主题</a> <a href="/friends/" class="dropdown-menu button">友链</a> <a href="/about/" class="dropdown-menu button">关于</a> <a href="/event/" class="dropdown-menu button">大事记</a> <a href="/atom.xml" class="dropdown-menu button">RSS</a></div></div></header><main class="main"><div class="post-title"><h1 class="post-title__text">GIT 安全使用指南</h1><div class="post-title__meta"><a href="/archives/2024/04/" class="post-meta__date button">2024-04-03</a> <span class="separate-dot"></span><a href="/categories/Git/" class="button">Git</a> <span id="busuanzi_container_page_pv" hidden><span class="separate-dot"></span> <span></span> <span id="busuanzi_value_page_pv"></span> <span>Views</span></span></div></div><aside class="post-side"><div class="post-side__toc"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-number">1.</span> <span class="toc-text">概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%80%E6%BA%90%E4%BE%9B%E5%BA%94%E9%93%BE%E6%94%BB%E5%87%BB%EF%BC%88Open-source-supply-chain-attack%EF%BC%89"><span class="toc-number">1.1.</span> <span class="toc-text">开源供应链攻击（Open source supply chain attack）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%80%E6%BA%90%E9%9A%90%E7%A7%81%E6%B3%84%E9%9C%B2%EF%BC%88Open-source-privacy-leak%EF%BC%89"><span class="toc-number">1.2.</span> <span class="toc-text">开源隐私泄露（Open source privacy leak）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Action-%E8%A1%8C%E5%8A%A8"><span class="toc-number">2.</span> <span class="toc-text">Action 行动</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Initiation-%C9%AA%CB%8Cn%C9%AA%CA%83-i%CB%88e%C9%AA-%CA%83%C9%99n-%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-number">2.1.</span> <span class="toc-text">Initiation [&#x2F;ɪˌnɪʃ.iˈeɪ.ʃən&#x2F;] 初始化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Git-Proxy"><span class="toc-number">2.2.</span> <span class="toc-text">Git Proxy</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Use-SSH-over-HTTPS-prot"><span class="toc-number">2.3.</span> <span class="toc-text">Use SSH over HTTPS prot</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Verify-commit-signature"><span class="toc-number">2.4.</span> <span class="toc-text">Verify commit signature</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Commit-message-%E6%8F%90%E4%BA%A4%E8%A7%84%E8%8C%83"><span class="toc-number">2.5.</span> <span class="toc-text">Commit message 提交规范</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PGP-%E4%BD%BF%E7%94%A8"><span class="toc-number">3.</span> <span class="toc-text">PGP 使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E5%AF%86%E9%92%A5"><span class="toc-number">3.1.</span> <span class="toc-text">生成密钥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%A1%E7%90%86%E5%AF%86%E9%92%A5"><span class="toc-number">3.2.</span> <span class="toc-text">管理密钥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%87%E4%BB%BD%E5%AF%86%E9%92%A5-backup-certification"><span class="toc-number">3.3.</span> <span class="toc-text">备份密钥 backup certification</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4-delete"><span class="toc-number">3.4.</span> <span class="toc-text">删除 delete</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5-import-key-certification"><span class="toc-number">3.5.</span> <span class="toc-text">导入 import key certification</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AD%BE%E5%90%8D%E5%92%8C%E9%AA%8C%E8%AF%81-sign-and-verify"><span class="toc-number">3.6.</span> <span class="toc-text">签名和验证 sign and verify</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GPG-Editer"><span class="toc-number">3.7.</span> <span class="toc-text">GPG Editer</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference-%E5%8F%82%E8%80%83"><span class="toc-number">4.</span> <span class="toc-text">Reference 参考</span></a></li></ol></div></aside><a class="btn-toc button" id="btn-toc" tabindex="0"><svg viewBox="0 0 1024 1024" width="32" height="32" xmlns="http://www.w3.org/2000/svg"><path d="M128 256h64V192H128zM320 256h576V192H320zM128 544h64v-64H128zM320 544h576v-64H320zM128 832h64v-64H128zM320 832h576v-64H320z" fill="currentColor"></path></svg></a><div class="toc-menus" id="toc-menus"><div class="toc-title">Article Directory</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-number">1.</span> <span class="toc-text">概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%80%E6%BA%90%E4%BE%9B%E5%BA%94%E9%93%BE%E6%94%BB%E5%87%BB%EF%BC%88Open-source-supply-chain-attack%EF%BC%89"><span class="toc-number">1.1.</span> <span class="toc-text">开源供应链攻击（Open source supply chain attack）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%80%E6%BA%90%E9%9A%90%E7%A7%81%E6%B3%84%E9%9C%B2%EF%BC%88Open-source-privacy-leak%EF%BC%89"><span class="toc-number">1.2.</span> <span class="toc-text">开源隐私泄露（Open source privacy leak）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Action-%E8%A1%8C%E5%8A%A8"><span class="toc-number">2.</span> <span class="toc-text">Action 行动</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Initiation-%C9%AA%CB%8Cn%C9%AA%CA%83-i%CB%88e%C9%AA-%CA%83%C9%99n-%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-number">2.1.</span> <span class="toc-text">Initiation [&#x2F;ɪˌnɪʃ.iˈeɪ.ʃən&#x2F;] 初始化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Git-Proxy"><span class="toc-number">2.2.</span> <span class="toc-text">Git Proxy</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Use-SSH-over-HTTPS-prot"><span class="toc-number">2.3.</span> <span class="toc-text">Use SSH over HTTPS prot</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Verify-commit-signature"><span class="toc-number">2.4.</span> <span class="toc-text">Verify commit signature</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Commit-message-%E6%8F%90%E4%BA%A4%E8%A7%84%E8%8C%83"><span class="toc-number">2.5.</span> <span class="toc-text">Commit message 提交规范</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PGP-%E4%BD%BF%E7%94%A8"><span class="toc-number">3.</span> <span class="toc-text">PGP 使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E5%AF%86%E9%92%A5"><span class="toc-number">3.1.</span> <span class="toc-text">生成密钥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%A1%E7%90%86%E5%AF%86%E9%92%A5"><span class="toc-number">3.2.</span> <span class="toc-text">管理密钥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%87%E4%BB%BD%E5%AF%86%E9%92%A5-backup-certification"><span class="toc-number">3.3.</span> <span class="toc-text">备份密钥 backup certification</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4-delete"><span class="toc-number">3.4.</span> <span class="toc-text">删除 delete</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5-import-key-certification"><span class="toc-number">3.5.</span> <span class="toc-text">导入 import key certification</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AD%BE%E5%90%8D%E5%92%8C%E9%AA%8C%E8%AF%81-sign-and-verify"><span class="toc-number">3.6.</span> <span class="toc-text">签名和验证 sign and verify</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GPG-Editer"><span class="toc-number">3.7.</span> <span class="toc-text">GPG Editer</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference-%E5%8F%82%E8%80%83"><span class="toc-number">4.</span> <span class="toc-text">Reference 参考</span></a></li></ol></div><article class="post post__with-toc content-card"><div class="post__header"><div class="post__expire" id="post-expired-notify"><p>This article was last updated on &lt;span id=&#34;expire-date&#34;&gt;&lt;/span&gt; days ago, the information described in the article may be outdated.</p></div><script>(() => {
            var update = Date.parse("2024-04-03"),
                date = new Date(),
                now = date.getTime(),
                expire = now - update,
                expire_days = Math.floor(expire/(24*3600*1000));
            if (expire_days >= 120) {
                document.querySelectorAll('#expire-date')[0].innerHTML = expire_days;
                document.querySelectorAll('#post-expired-notify')[0].style.display = 'block';
            }
        })();</script></div><div class="post__content"><h1 id="Git-安全使用指南"><a href="#Git-安全使用指南" class="headerlink" title="Git 安全使用指南"></a>Git 安全使用指南</h1><p>每时每刻，网络上成千上万的机器人贪婪的检索 GitHub，这包括开源软件 Attacker, Hacker ,甚至于受国家政府支持的 Attacker。</p><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><h3 id="开源供应链攻击（Open-source-supply-chain-attack）"><a href="#开源供应链攻击（Open-source-supply-chain-attack）" class="headerlink" title="开源供应链攻击（Open source supply chain attack）"></a>开源供应链攻击（Open source supply chain attack）</h3><p>近年来，<strong>供应链攻击事件</strong> 不断频发。过去一年中，恶意软件包上传到各种公共包管理库的事件数量呈爆炸式增长，这表明攻击者越来越青睐这种初始访问策略。根据软件供应链管理公司 Sonatype 的数据，在各个开源生态系统中检测到的恶意软件包数量同比增长了两倍。</p><p>开源软件供应链指的是广泛使用的第三方库、框架、组件等。例如 Python 的 fastapi、flask、requests 等，JavaScript 的 vue3、express、axios、lodash 等，Kubernetes，Docker，等服务工具。这些都是网络基础设施的重要组成部分。</p><p>幸运的是，这些网络基础设施都是 Open Source 的，任何人都能对其代码进行 review。但黑客也会利用这一点，用自己的 contributor 身份，抑或是盗取具有 contributor permission 账号的 cookie，巧妙地向开源软件下毒，这种下毒方式短时间内不会立即发现，随着软件依赖库的更新被分发到世界各地的互联网关键设施，黑客就能进出自由的控制政府、企业、个人的网络设备。</p><p>例如开发者可以通过修改 Python 的 dependency 的 requirements.txt ，当使用者下载并运行时，攻击开始了。</p><pre><code class="hljs shell"><span class="hljs-meta prompt_">aiohttp&gt;</span><span class="language-bash">=3.6.0,&lt;3.9.0</span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">恶意软件包 透过冒充的域名 pythonhosted.org 的网站下载</span>
https://files.pythonhosted.org/packages/18/93/1f005bbe044471a0444a82cdd7356f5120b9cf94fe2c50c0cdbf28f1258b/aiohttp-3.9.3.tar.gz</code></pre><p>所以作为开发者，我们需要时刻保持警惕，不要随意下载未知的依赖库，尽可能使用官方源进行下载。有条件就进行 code review，或者使用一些安全工具进行扫描。</p><h3 id="开源隐私泄露（Open-source-privacy-leak）"><a href="#开源隐私泄露（Open-source-privacy-leak）" class="headerlink" title="开源隐私泄露（Open source privacy leak）"></a>开源隐私泄露（Open source privacy leak）</h3><p>每天数以百万计的机器人在 GitHub 上检索代码，匹配代码中的敏感信息，各种 Key&#x2F;Session&#x2F;Token&#x2F;password&#x2F;数据库密码&#x2F;CardID&#x2F;CreditCard 等。很多开发者贪图方便，开发时将这些敏感信息硬编码在代码中，这样一来，如果开源到 GitHub 上，就自我开盒了。</p><p>有证据表明，中国政府会重点关注敏感项目(如FQ、Politics等)的 contributor 甚至 star ，尝试通过 profile、commit、issue、email、social media 精准定位墙内信息，精准喝茶。</p><p>解决方法也很简单：</p><ol><li>打开 GitHub 的 Code security and analysis（代码安全和分析）-&gt; Push protection for yourself (保护自己的推送)，这样就可以 Block commits that contain supported secrets across all public repositories on GitHub. （阻止包含支持的秘密的提交）</li><li>不要偷懒，将敏感信息存储在环境变量中，或者使用专门的配置文件进行管理。并加入到 .gitignore 文件中，<strong>不要上传到 GitHub 上</strong>。</li><li>敏感的 repository 设置为 <strong>private</strong>，不要公开。</li><li>使用 GitHub 提供的 Keep my email addresses private (保持我的邮箱私密)，透过私密邮箱进行 commit。</li><li>GitHub 开启 Two-Factor Authentication(2FA 双因素验证)，增加账号安全性。</li></ol><h2 id="Action-行动"><a href="#Action-行动" class="headerlink" title="Action 行动"></a>Action 行动</h2><h3 id="Initiation-ɪˌnɪʃ-iˈeɪ-ʃən-初始化"><a href="#Initiation-ɪˌnɪʃ-iˈeɪ-ʃən-初始化" class="headerlink" title="Initiation [&#x2F;ɪˌnɪʃ.iˈeɪ.ʃən&#x2F;] 初始化"></a>Initiation [&#x2F;ɪˌnɪʃ.iˈeɪ.ʃən&#x2F;] 初始化</h3><p>配置全局用户名和邮箱</p><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">配置全局用户名和邮箱</span>
git config --global user.name &quot;whalefell&quot;
git config --global user.email &quot;whalefall@unimelb.edu.au&quot;
<span class="hljs-meta prompt_"># </span><span class="language-bash">查看配置</span>
git config --list</code></pre><p>ssh-keygen 使用 <strong>RSA算法</strong> 生成 SSH key ，并将公钥添加到 GitHub 上。<br>可以选择输入 <code>passphrase</code> 更加安全。<br>位置：公钥 <code>~/.ssh/id_rsa.pub</code> 私钥 <code>~/.ssh/id_rsa</code><br>妥善保管上面两个文件，一同放在 KeePass 中。</p><pre><code class="hljs shell">ssh-keygen -t rsa -C &quot;youremail@example.com&quot;
<span class="hljs-meta prompt_"># </span><span class="language-bash">verify</span>
ssh -T git@github.com</code></pre><p>创建 repository</p><pre><code class="hljs shell">git init .
git add .
git commit -m &quot;initiation&quot;</code></pre><h3 id="Git-Proxy"><a href="#Git-Proxy" class="headerlink" title="Git Proxy"></a>Git Proxy</h3><p>由于高墙的存在, 需要使用代理进行访问. I know this because it’s necessary for Chinese guys, lol.</p><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash"><span class="hljs-built_in">set</span> http proxy but it only working <span class="hljs-keyword">in</span> http(s) git protocol</span>
git config --global http.proxy http://127.0.0.1:10809
git config --global https.proxy https://127.0.0.1:10809
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">clear proxy</span>
git config --global --unset http.proxy
git config --global --unset https.proxy
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">SSH proxy</span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">edit `~/.ssh/config`</span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">socks5</span>
Host *
    ProxyCommand connect -S &#123;proxyserver&#125;:&#123;port&#125; %h %p
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">http</span>
Host *
    ProxyCommand connect -H &#123;proxyserver&#125;:&#123;port&#125; %h %p
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">windows</span>
Host *
ProxyCommand &quot;D:\Git\mingw64\bin\connect.exe&quot; -S 127.0.0.1:10808 %h %p
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">temporary proxy</span>
-o ProxyCommand=&quot;path\to\connect.exe -S 127.0.0.1:7891 %h %p&quot;
</code></pre><p>解决了一个迷思: 为什么 HTTP 代理能够代理很多非 HTTP 协议的请求?</p><p>ref: <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/12026247/why-are-http-proxies-able-to-support-protocols-like-irc-and-ftp">stackoverflow: why-are-http-proxies-able-to-support-protocols-like-irc-and-ftp</a></p><blockquote><p>Q: Why are HTTP proxies able to support protocols like socks and FTP?</p><p>A: HTTP proxy is able to support high level protocols other than HTTP,Because it supports CONNECT method,<br>HTTP 代理能够支持除了HTTP以外很多高级别的协议, 因为它支持 <strong>CONNECT</strong> 方法.</p><p>The CONNECT method is a way <strong>to tunnel any kind of connection</strong> through an HTTP proxy. By default, the proxy establishes a TCP connection to the specified server, responds with an HTTP 200 (Connection Established) response, and then shovels packets back and forth between the client and the server, <strong>without understanding or interpreting the tunnelled traffic</strong><br>CONNECT 方法是一种通过HTTP代理隧道化任何连接的方法. 代理默认建立一个到指定服务器的TCP连接, 响应一个HTTP 200 (Connection Established) 响应, 然后在客户端和服务器之间来回传输数据包, 而不理解或解释隧道流量.</p><p>简单理解, HTTP 代理通过 CONNECT 方法将 TCP 的数据打包转发给目标服务器, 然后将数据包原封不动的返回给客户端, 从而实现了对非 HTTP 协议的支持. HTTP 代理支持所有基于 TCP 的协议, 但是不支持 UDP 协议.</p></blockquote><h3 id="Use-SSH-over-HTTPS-prot"><a href="#Use-SSH-over-HTTPS-prot" class="headerlink" title="Use SSH over HTTPS prot"></a>Use SSH over HTTPS prot</h3><p>Use SSH over HTTPS prot: 通过 443 端口使用 SSH 协议，避免被 Firewall 阻挡。</p><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">verify</span>
ssh -T -p 443 git@ssh.github.com
git clone ssh://git@ssh.github.com:443/YOUR-USERNAME/YOUR-REPOSITORY.git</code></pre><h3 id="Verify-commit-signature"><a href="#Verify-commit-signature" class="headerlink" title="Verify commit signature"></a>Verify commit signature</h3><p>使用 GPG 验证并签名你的提交，您可以在本地签名提交。这些标签或提交在 GitHub 上标记为 <strong>已验证的绿色小勾 Verified</strong>，因此其他人可以确信更改来自 <strong>可信来源</strong>。有关 PGP 的使用见下一 part。</p><pre><code class="hljs shell">gpg --list-keys  # 列出所有密钥
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">公钥特征，包括了密钥的参数</span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">加密算法是 rsa，长度为 2048，生成于 2019-08-04，用途是 Signing 和 Certificating，一年之后过期以及密钥的 ID。</span>
pub   rsa2048 2019-08-04 [SC] [expires: 2021-08-03]
      1BA074F113915706D141348CDC3DB5873563E6B2
<span class="hljs-meta prompt_"># </span><span class="language-bash">生成密钥时所输入的个人信息。</span>
uid           [ultimate] fortest &lt;test@test.com&gt;
<span class="hljs-meta prompt_"># </span><span class="language-bash">子密钥特征，格式和公钥部分大致相同</span>
sub   rsa2048 2019-08-04 [E] [expires: 2021-08-03]
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">根据密钥 ID 导出对应的 GPG 公钥字符串</span>
gpg --armor --export &#123;key_id&#125;</code></pre><p>然后，在 Github 的 SSH and GPG keys 中，新增一个 GPG key，内容即是上述命令的输出结果。</p><p>再次提醒，GPG 密钥中个人信息的邮箱部分，必须使用在 Github 中验证过的邮箱，否则添加 GPG key 会提示未经验证。</p><p>配置 Private email：</p><pre><code class="hljs shell">gpg --list-secret-keys --keyid-format=long
gpg --edit-key &#123; sub_key_id &#125;
adduid # 添加一个新的邮箱
save
<span class="hljs-meta prompt_"># </span><span class="language-bash">导出字符串并添加到 GitHub</span>
gpg --armor --export &#123; sub_key_id &#125;</code></pre><p>利用 GPG 私钥对 Git commit 进行签名:</p><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">设置签名所用的 GPG 密钥 ID</span>
git config --global user.signingkey &#123;key_id&#125;
<span class="hljs-meta prompt_"># </span><span class="language-bash">在每次 commit 的时候，加上-S参数，表示这次提交需要用 GPG 密钥进行签名</span>
git commit -S -m &quot;...&quot;
<span class="hljs-meta prompt_"># </span><span class="language-bash">如果觉得每次都需要手动加上-S有些麻烦，可以设置 Git 为每次 commit 自动要求签名：</span>
git config --global commit.gpgsign true</code></pre><p>信任 GitHub 的 GPG 密钥：虽然所有的 commit 在 Github 中查看都是 <strong>Verified</strong>，但是有一些比较特殊：在 Github 网页端进行的操作，比如创建仓库。这些 commit 并没有用我们之前生成的密钥进行签名，而是由 Github 代为签名了。这样的结果就是，我们本地无法确认这些签名的真实性。</p><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">import GitHub GPG key</span>
curl https://github.com/web-flow.gpg | gpg --import
<span class="hljs-meta prompt_"># </span><span class="language-bash">sign and trust GitHub GPG key</span>
gpg --sign-key 4AEE18F83AFDEB23</code></pre><p>这时候，每一次 commit 都要输入 passphrase，可以使用 <code>gpg-agent</code> 来缓存密码，避免重复输入。</p><p><code>~/.gnupg/gpg-agent.conf</code>:</p><pre><code class="hljs shell">default-cache-ttl 3600</code></pre><h3 id="Commit-message-提交规范"><a href="#Commit-message-提交规范" class="headerlink" title="Commit message 提交规范"></a>Commit message 提交规范</h3><p>使用 angular commit message 规范，这是一个非常流行的 commit message 规范.</p><ul><li><code>feat</code> 增加新功能</li><li><code>fix</code> 修复问题&#x2F;BUG</li><li><code>style</code> 代码风格相关无影响运行结果的</li><li><code>perf</code> 优化&#x2F;性能提升</li><li><code>refactor</code> 重构</li><li><code>revert</code> 撤销修改</li><li><code>test</code> 测试相关</li><li><code>docs</code> 文档&#x2F;注释</li><li><code>chore</code> 依赖更新&#x2F;脚手架配置修改等</li><li><code>workflow</code> 工作流改进</li><li><code>ci</code> 持续集成</li><li><code>types</code> 类型定义文件更改</li><li><code>wip</code> 开发中</li></ul><h2 id="PGP-使用"><a href="#PGP-使用" class="headerlink" title="PGP 使用"></a>PGP 使用</h2><blockquote><p>世界上有两种密码:一种是防止你的小妹妹偷看你的文件;另一种是防止当局阅读你的文件.<br>—— Bruce Schneier《应用密码学》</p></blockquote><p><code>GNU Privacy Guard</code>（GnuPG 或 GPG）是一个密码学软件，用于<strong>加密、签名</strong>通信内容及<strong>管理 非对称 密码学的密钥</strong>。</p><p>非对称密码大家应该接触过，这项技术在许多领域都有适用。这种算法需要两个 <strong>钥匙</strong>，一个是可以公开的 <strong>公钥</strong> ，对应的另一个就是应保管好的 <strong>私钥</strong> 。<strong>用公钥加密的内容只能使用私钥解开，而使用私钥加密的内容也只能使用公钥解开。</strong></p><p>目前计算机难以高效地进行<strong>质因数分解</strong>，比如我们将 2147483647 乘以 998244353 利用计算机很容易得到结果 2143713423777595391 ，但是反过来就扔给你一个 2143713423777595391 很难反推出原来两个质数。</p><p>利用这个特性，加上一个合适的流程，我们就得到了一个加密手段。</p><p>如果假象我们在使用一个去中心化通讯平台，每个人有唯一的一个<strong>账号（公钥）和密码（私钥）</strong>，我要私聊一个朋友，内容肯定不想让别人知道，但是在去中心化网络中难以避免经过别人转手，这时候我就可以<strong>拿那位朋友的账号（公钥）加密</strong>，这样只有那位<strong>朋友使用自己的私钥</strong>才能解开这些内容；同样的，他怎么确定信息是我发出的而不是别人<strong>伪造我的身份</strong>发出的呢？那我在<strong>用他的公钥加密后再使用自己的私钥加密</strong>（也叫 Signature），他使用<strong>我的公钥发现能解开</strong>，那就必是我发出的无疑了。（但是你的私钥泄露了就……）</p><p>PGP能保证 一条信息是你相信的人发的，除了你俩之外别人无法解密， 而且这条消息在传送时中间没有经过任何哪怕是一个标点一个字节的修改。</p><p>名词解释：</p><pre><code class="hljs text">A    =&gt;    Authentication
C    =&gt;    Certify
E    =&gt;    Encrypt
S    =&gt;    Sign
?    =&gt;    Unknown capability
sec  =&gt;    Secret Key
ssb  =&gt;    Secret SuBkey
pub  =&gt;    Public Key
sub  =&gt;    Public Subkey</code></pre><h3 id="生成密钥"><a href="#生成密钥" class="headerlink" title="生成密钥"></a>生成密钥</h3><p>PGP 的密钥分为两种：<strong>主密钥</strong> 和 <strong>子密钥</strong>，主密钥用于签名和认证，子密钥用于加密。只需要主密钥的公钥就行，包含了子密钥的信息。</p><p>生成主密钥：</p><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">step 0</span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">这里不推荐使用的 `gpg --gen-key`</span>
gpg --full-gen-key
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">step 1</span>
<span class="hljs-meta prompt_"># </span><span class="language-bash"> 默认就可以</span>
Please select what kind of key you want:
   (1) RSA and RSA (default)
   (2) DSA and Elgamal
   (3) DSA (sign only)
   (4) RSA (sign only)
  (14) Existing key from card
Your selection?
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">step 2</span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">此处输入你希望的密钥长度， RSA的不应低于2048 bits，当然输入的数字越大越安全，相应的，加解密的速度也会更慢</span>
RSA keys may be between 1024 and 4096 bits long.
What keysize do you want? (4096)
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">step 3</span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">默认可以选0 ，即永不过期， 这里我选了2y，  因为到期之前随时可以更改你的过期时间，以确保你对此密钥仍拥有控制权</span>
Please specify how long the key should be valid.
         0 = key does not expire
      &lt;n&gt;  = key expires in n days
      &lt;n&gt;w = key expires in n weeks
      &lt;n&gt;m = key expires in n months
      &lt;n&gt;y = key expires in n years
Key is valid for? (0)  2y
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">step 4</span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">注意了： 这里的邮箱， 如果你不打算使用PGP为你的Git记录认证， 这里其实是可以随便输入的，不需要是你的邮箱， 甚至不需要是一个真实存在的邮箱，只要接受你信息的人知道就行。隐私泄漏问题很严重，你一旦设置了，并且发布到公钥服务器，就永远删不掉了 😅</span>

GnuPG needs to construct a user ID to identify your key.
Real name:  linus   # 这里名字可以是网名，可以是任意名字，如果你注重隐私就不要输入自己真名了
Email address: linus@outlook.com
Comment:     # 备注可以留空
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">step 6</span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">确认无误后输入 o</span>
You selected this USER-ID:
    &quot;linus &lt;linust@outlook.com&gt;&quot;

Change (N)ame, (C)omment, (E)mail or (O)kay/(Q)uit? o
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">step 7</span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">输入一个复杂的密码 并确认</span>
┌──────────────────────────────────────────────────────┐
│ Please enter the passphrase to                       │
│ protect your new key                                 │
│                                                      │
│ Passphrase: │________________________________________│
│                                                      │
│       &lt;OK&gt;                              &lt;Cancel&gt;     │
└──────────────────────────────────────────────────────┘
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">step 8</span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">随机移动你的鼠标，越随机你的密钥越安全</span>
We need to generate a lot of random bytes. It is a good idea to perform
some other action (type on the keyboard, move the mouse, utilize the
disks) during the prime generation; this gives the random number
generator a better chance to gain enough entropy.
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">step 9 大功告成</span>
gpg: key 99F583599B7E31F1 marked as ultimately trusted
gpg: revocation certificate stored as &#x27;/root/.gnupg/openpgp-revocs.d/705358AB85366CAB05C0220F99F583599B7E31F1.rev&#x27;
public and secret key created and signed.

pub   rsa3072 2021-01-11 [SC]
      705358AB85366CAB05C0220F99F583599B7E31F1    # 你的 key id
uid                      linus &lt;linus@outlook.com&gt;
sub   rsa3072 2021-01-11 [E]    # 这个是自动生成的用于加密的子密钥，E代表Encrypt 加密</code></pre><p>生成子密钥：你日常使用应该使用子密钥，<strong>主密钥除了签发新的子密钥</strong> 不要使用。建议为不同环境，不同用途都单独生成子密钥，互不干扰。</p><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">step 0</span>
gpg --edit-key linus # 或者key id
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">step 1  进入gpg交互界面</span>
gpg (GnuPG) 2.2.20; Copyright (C) 2020 Free Software Foundation, Inc.
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

Secret key is available.

sec  rsa3072/99F583599B7E31F1
     created: 2021-01-11  expires: never       usage: SC
     trust: ultimate      validity: ultimate
ssb  rsa3072/6FE9C71CFED44076
     created: 2021-01-11  expires: never       usage: E
[ultimate] (1). linus &lt;linus@outlook.com&gt;C
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">step 2</span>
<span class="hljs-meta prompt_">gpg&gt; </span><span class="language-bash">  addkey</span>
Please select what kind of key you want:
   (3) DSA (sign only)
   (4) RSA (sign only)
   (5) Elgamal (encrypt only)
   (6) RSA (encrypt only)
  (14) Existing key from card
Your selection? 4
<span class="hljs-meta prompt_"># </span><span class="language-bash">根据你的用途选择， 这里生成一个只用于签名的子密钥（sign only）</span>
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash"> 后面的选择和主密钥生成的大同小异，按提示操作即可</span>
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">生成完毕后</span>
sec  rsa3072/99F583599B7E31F1
     created: 2021-01-11  expires: never       usage: SC
     trust: ultimate      validity: ultimate
ssb  rsa3072/6FE9C71CFED44076
     created: 2021-01-11  expires: never       usage: E
ssb  rsa3072/FDB960B857D397F6
     created: 2021-01-11  expires: never       usage: S
[ultimate] (1). linus &lt;linus@outlook.com&gt;
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash"> last step</span>
<span class="hljs-meta prompt_">gpg&gt; </span><span class="language-bash"> save  <span class="hljs-comment">#  记得save， 直接退出的话什么也没有</span></span></code></pre><p>生成撤销证书 revoke certification</p><p>假如你忘了主密钥的密码，或者丢失了对主密钥的控制权（丢失，被夺取），如果没有 <strong>撤销凭证</strong> 的话， 除了一个个通知你的朋友们没有任何办法 证明你不再使用这个密钥，这简直是灾难。</p><p>生成的 <code>revoke.pgp</code> 就是撤销凭证， 有了这个撤销凭证，你可以在没有密码的情况下 <strong>使一个公钥失效</strong>，所以一定要妥善保存，而且最好比主密钥多一份。</p><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">step 0</span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">按提示走完流程就可以</span>
gpg --gen-revoke -ao revoke.pgp linus # uid 或者key id
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">step 1</span>
sec  rsa3072/99F583599B7E31F1 2021-01-11 linus &lt;linus@outlook.com&gt;

Create a revocation certificate for this key? (y/N) y
Please select the reason for the revocation:
  0 = No reason specified
  1 = Key has been compromised # 密钥被泄露
  2 = Key is superseded
  3 = Key is no longer used
  Q = Cancel
(Probably you want to select 1 here) 3</code></pre><p>由于 PGP 没有提供任何 <strong>将吊销信息通知其他用户的方式</strong>，他不能保证没人会使用撤销了的已经变得不安全的密钥。</p><p>你丢失的私钥仍然可以被攻击者使用，并用来解密那些没有更新你的公钥的人发送的加密消息。 revoke 子密钥并更新公钥后，若有人用老的公钥加密信息，虽然你仍然可以解密，但是攻击者同样可以，这时候是极度不安全的。</p><p>例如：如果A的私人密钥被盗，她将发出一个 <strong>密钥撤销证书</strong>（key revocation certificate），但是由于这个密钥的分发是非正式的且将费大量的时间和口舌，故不能保证密钥环中每一个有 A 公开密钥的用户都能收到。</p><p>所以在你将密钥<strong>撤销</strong>后，请将发布到你一贯公布公钥的地方， 并尽可能通知其他人。</p><p>撤销主密钥：</p><pre><code class="hljs shell">gpg --import gpg-linus.asc                                               # 在一台新的电脑上导入你的公钥
gpg: key 99F583599B7E31F1: &quot;linus &lt;linus@outlook.com&gt;&quot; not changed
gpg: Total number processed: 1
gpg:              unchanged: 1

gpg --import revoke  # 导入你备份的撤销凭证，直接会导致密钥不可用
<span class="hljs-meta prompt_"># </span><span class="language-bash">detail</span>
gpg: key 99F583599B7E31F1: &quot;linus &lt;linus@outlook.com&gt;&quot; revocation certificate imported
gpg: Total number processed: 1
gpg:    new key revocations: 1
gpg: marginals needed: 3  completes needed: 1  trust model: pgp
gpg: depth: 0  valid:   1  signed:   1  trust: 0-, 0q, 0n, 0m, 0f, 1u
gpg: depth: 1  valid:   1  signed:   0  trust: 1-, 0q, 0n, 0m, 0f, 0u
gpg: next trustdb check due at 2021-09-29

gpg -k                 # 查看密钥，已经revoke
<span class="hljs-meta prompt_"># </span><span class="language-bash">detail</span>
pub   rsa3072 2021-01-11 [SC] [revoked: 2021-01-11]
      705358AB85366CAB05C0220F99F583599B7E31F1
uid           [revoked] linus &lt;linus@outlook.com&gt;</code></pre><p>撤销子密钥：</p><pre><code class="hljs shell">gpg --edit-key linus

gpg &gt;   list  # 列出你所有的子密钥
gpg &gt;   key  &#123;n&#125;  # 选择你要销毁的子密钥的 序号
gpg &gt;   revkey
gpg &gt;   save    # 退出前一定要save, 不然所有更改不会生效</code></pre><p>由于吊销前进行加密的内容仍需被吊销的密钥进行解密，所以被吊销的密钥也<strong>不应丢弃</strong>。</p><p>此外，若将 PGP 用于 SSH 认证，由于SSH的私钥认证并不通过主密钥来认证，所以即使吊销私钥，也可以进行访问，所以吊销后应当修改使用该密钥的SSH服务端来避免非法访问。</p><h3 id="管理密钥"><a href="#管理密钥" class="headerlink" title="管理密钥"></a>管理密钥</h3><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">列出所有公钥、子公钥</span>
gpg --list-keys
<span class="hljs-meta prompt_"># </span><span class="language-bash">列出所有密钥、子密钥</span>
gpg --list-secret-keys
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">简化</span>
gpg -k
gpg -K
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">这样并没有列出子密钥的<span class="hljs-built_in">id</span>, 而且没有打印出指纹信息， 是不安全的。所以在你查看密钥时应该</span>
gpg --fingerprint -K --keyid-format long
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"> # </span><span class="language-bash">输出</span>
sec   rsa3072/0x99F583599B7E31F1 2021-01-11 [SC]  # 长ID
      Key fingerprint = 7053 58AB 8536 6CAB 05C0  220F 99F5 8359 9B7E 31F1 #指纹信息
uid                   [ultimate] linus &lt;linus@outlook.com&gt;
ssb   rsa3072/0x6FE9C71CFED44076 2021-01-11 [E]            # 斜杠后面的就是子密钥ID
ssb   rsa3072/0xFDB960B857D397F6 2021-01-11 [S]</code></pre><h3 id="备份密钥-backup-certification"><a href="#备份密钥-backup-certification" class="headerlink" title="备份密钥 backup certification"></a>备份密钥 backup certification</h3><pre><code class="hljs shell">gpg --list-secret-keys --keyid-format=long
<span class="hljs-meta prompt_"># </span><span class="language-bash">备份步骤</span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">step 1: 导出秘钥信息，其中包括所有公钥，私钥，信任网数据库文件，进行备份</span>
gpg --export &gt; public-keys.gpg
gpg --export-secret-keys &gt; private-keys.gpg
gpg --export-ownertrust &gt; ownertrust.asc
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">step 2: 导出秘钥吊销凭证，建议单独备份</span>
gpg --armor --gen-revoke [primary key ID] &gt; revocation.asc
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">恢复秘钥</span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">step 1: 导出公钥，私钥和信任网数据库</span>
gpg --import public-keys.gpg
gpg --import private-keys.gpg
gpg --import-ownertrust ownertrust.asc
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">字符串文件备份</span>
gpg -ao public-key --export linus   # 导出公钥
gpg  -ao secret-key --export-secret-key 99F583599B7E31F1!    # 导出主私钥，建议secret-key 替换为你的加密设备备份文件的路径，直接导入到设备中
gpg  -ao sign-subkey --export-secret-subkeys FDB960B857D397F6!     #导出有[S]标识、签名用子私钥
gpg  -ao encrypt-subkey --export-secret-subkeys 6FE9C71CFED44076!    #导出有[E]标识、加密用子私钥 ,这里的ID替换为你的子密钥ID
<span class="hljs-meta prompt_"># </span><span class="language-bash">别忘了同时将你刚刚生成的撤销凭证也备份起来</span></code></pre><h3 id="删除-delete"><a href="#删除-delete" class="headerlink" title="删除 delete"></a>删除 delete</h3><p>备份完后，要将本机的密钥清除干净，首先删除：</p><pre><code class="hljs shell">gpg --delete-secret-keys linus  # 删除私钥，  UID 也可以替换成子密钥ID, 主密钥Key ID
gpg --delete-keys linus   # 删除公钥
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">如果想全部删除推荐直接删文件夹,即删除 <span class="hljs-variable">$HOME</span>/.gnupg</span></code></pre><h3 id="导入-import-key-certification"><a href="#导入-import-key-certification" class="headerlink" title="导入 import key certification"></a>导入 import key certification</h3><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">从文件导入</span>
gpg --import [密钥文件]   # 刚刚备份的子密钥文件， 或者其他人的公钥
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">暂不推荐从公钥服务器导入</span>
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">输出</span>
<span class="hljs-meta prompt_">sec# </span><span class="language-bash">  rsa3072/0x99F583599B7E31F1 2021-01-11 [SC]   <span class="hljs-comment"># sec 后面带有 # 号说明主密钥未导入，是安全的</span></span>
      Key fingerprint = 7053 58AB 8536 6CAB 05C0  220F 99F5 8359 9B7E 31F1 #指纹信息
uid                   [unknown] linus &lt;linus@outlook.com&gt;
ssb #    rsa3072/0x6FE9C71CFED44076 2021-01-11 [E]           # 带有 # 号说明该子密钥已导入</code></pre><h3 id="签名和验证-sign-and-verify"><a href="#签名和验证-sign-and-verify" class="headerlink" title="签名和验证 sign and verify"></a>签名和验证 sign and verify</h3><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">第一种方式，生成二进制签名文件</span>
gpg --sign input.txt  # 当然也可以加上--output参数
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">第二种方式，生成ASCII格式签名</span>
gpg --clearsign input.txt
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">第三种，签名和原文本分开（前两种的签名文件中包含了所有原文本，所以体积会比较大）</span>
gpg --armor --detach-sign input.txt  #不加armor生成会二进制
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash"> 验证签名文件</span>
gpg --verify demo.txt.asc demo.txt</code></pre><p>文件加解密：</p><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">加密：</span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">recipient指定接收者的公钥ID</span>
gpg --recipient &#123;keyid/uid&#125; --output encrypt.txt --encrypt input.txt
<span class="hljs-meta prompt_"># </span><span class="language-bash">也可以按喜好加上--armor选项等</span>
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">我更喜欢用</span>
gpg  -se  -o  encrypt.txt  -r  &#123;keyid/uid&#125;   input.txt
<span class="hljs-meta prompt_"># </span><span class="language-bash">s代表签名  e代表加密</span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">o是 将结果 输出到文件  encrypt.txt</span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">r后面跟 接收者的 uid或者 key <span class="hljs-built_in">id</span>， 接收者的公钥必须已经导入过</span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">input.txt 是你要加密的文件</span>
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">解密：</span>
gpg --decrypt encrypt.txt --output decrypt.txt
<span class="hljs-meta prompt_"># </span><span class="language-bash">也可以</span>
gpg -d encrypt.txt   # 输出到终端 直接查看</code></pre><h3 id="GPG-Editer"><a href="#GPG-Editer" class="headerlink" title="GPG Editer"></a>GPG Editer</h3><pre><code class="hljs text">gpg --edit-key linus

quit：退出此菜单。
save：保存并退出。
help：显示帮助信息。
fpr：显示密钥指纹。
grip：显示密钥抓手。
list：列出密钥和用户ID。
uid：选择用户ID N。
key：选择子密钥N。
check：检查签名。
sign：签名选定的用户ID。
lsign：本地签名选定的用户ID。
tsign：用信任签名签名选定的用户ID。
nrsign：用不可撤销的签名签名选定的用户ID。
adduid：添加一个用户ID。
addphoto：添加一个照片ID。
deluid：删除选定的用户ID。
addkey：添加一个子密钥。
addcardkey：将密钥添加到智能卡。
keytocard：将密钥移动到智能卡。
bkuptocard：将备份密钥移动到智能卡。
delkey：删除选定的子密钥。
addrevoker：添加一个撤销密钥。
delsig：从选定的用户ID中删除签名。
expire：更改密钥或选定子密钥的过期日期。
primary：将选定的用户ID标记为主要的。
pref：列出偏好（专家）。
showpref：列出偏好（详细）。
setpref：为选定的用户ID设置偏好列表。
keyserver：为选定的用户ID设置首选密钥服务器URL。
notation：为选定的用户ID设置一个注解。
passwd：更改密码。
trust：更改所有者信任。
revsig：撤销选定用户ID上的签名。
revuid：撤销选定的用户ID。
revkey：撤销密钥或选定的子密钥。
enable：启用密钥。
disable：禁用密钥。
showphoto：显示选定的照片ID。
clean：压缩不可用的用户ID并从密钥中删除不可用的签名。
minimize：压缩不可用的用户ID并从密钥中删除所有签名。</code></pre><h2 id="Reference-参考"><a href="#Reference-参考" class="headerlink" title="Reference 参考"></a>Reference 参考</h2><ol><li><a target="_blank" rel="noopener" href="https://thehackernews.com/2024/03/hackers-hijack-github-accounts-in.html">thehackernews: hackers-hijack-github-accounts-in</a></li><li><a target="_blank" rel="noopener" href="https://docs.github.com/en/authentication/">GitHub Authentication</a></li></ol></div><div class="post__license"><p><strong>Author: </strong>WhaleFall</p><p><strong>Permalink: </strong><a href="https://www.whaleluo.top/github-security/">https://www.whaleluo.top/github-security/</a></p><strong><p>文章默认使用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">CC BY-NC-SA 4.0</a> 协议进行许可，使用时请注意遵守协议。</p></strong></div><div class="post-footer__meta"><p>updated at 2024-04-03</p></div><div class="post-entry__tags"><a href="/tags/GitHub/" class="post-tags__link button"># GitHub</a><a href="/tags/Cybersecurity/" class="post-tags__link button"># Cybersecurity</a><a href="/tags/OpenSourceSecurity/" class="post-tags__link button"># OpenSourceSecurity</a><a href="/tags/%E5%BC%80%E6%BA%90%E5%AE%89%E5%85%A8/" class="post-tags__link button"># 开源安全</a><a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" class="post-tags__link button"># 网络安全</a></div></article><div class="nav"><div class="nav__prev"><a href="/coding-english-world/" class="nav__link"><div><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="24" height="24"><path d="M589.088 790.624L310.464 512l278.624-278.624 45.248 45.248L400.96 512l233.376 233.376z" fill="#808080"></path></svg></div><div><div class="nav__label">Previous Post</div><div class="nav__title">程序员常用单词词汇表</div></div></a></div><div class="nav__next"><a href="/amateurradio/tecsun-pl330-radio-bonus/" class="nav__link"><div><div class="nav__label">Next Post</div><div class="nav__title">德生 PL-330 收音机彩蛋</div></div><div><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="24" height="24"><path d="M434.944 790.624l-45.248-45.248L623.04 512l-233.376-233.376 45.248-45.248L713.568 512z" fill="#808080"></path></svg></div></a></div></div><div class="post__comments post__with-toc content-card" id="comment"><h4>Comments</h4><div id="gitalk-container"></div></div></main><footer class="footer"><a href="#" class="button" id="b2t" aria-label="Back to Top" title="Back to Top"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" width="32" height="32"><path d="M233.376 722.752L278.624 768 512 534.624 745.376 768l45.248-45.248L512 444.128zM192 352h640V288H192z" fill="currentColor"></path></svg> </a><span id="busuanzi_container_site_uv" hidden><span></span> <span id="busuanzi_value_site_uv"></span> <span>Viewers</span> <span>|</span> </span><span id="busuanzi_container_site_pv" hidden><span></span> <span id="busuanzi_value_site_pv"></span> <span>Views</span></span><p class="footer-copyright">Copyright © 2018&nbsp;-&nbsp;2024 <a href="/">😊落落のBlog😊</a></p><p>Powered by <a href="https://hexo.io" target="_blank">Hexo</a> | Theme - <a href="https://github.com/ChrAlpha/hexo-theme-cards" target="_blank">Cards</a></p></footer></div><script defer src="https://api.whaleluo.top/file/?url=https://cdn.jsdelivr.net/npm/vanilla-lazyload@17.1.0/dist/lazyload.min.js"></script><script>window.lazyLoadOptions={elements_selector:".lazy",threshold:0}</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon='{"token": "e052e3fc47004feab6ae8122cfeec660"}'></script><script src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js"></script><link rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css"><script src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js"></script><script>let lazyloadT = Boolean('true'),
            auto_fancybox = Boolean('true')
        if (auto_fancybox) {
            $(".post__content").find('img').each(function () {
                var element = document.createElement("a");
                $(element).attr("data-fancybox", "gallery");
                $(element).attr("href", $(this).attr("src"));
                if (lazyloadT) {
                    $(element).attr("href", $(this).attr("data-srcset"));
                }
                $(this).wrap(element);
            });
        } else {
            $(".post__content").find("fancybox").find('img').each(function () {
                var element = document.createElement("a");
                $(element).attr("data-fancybox", "gallery");
                $(element).attr("href", $(this).attr("src"));
                if (lazyloadT) {
                    $(element).attr("href", $(this).attr("data-srcset"));
                }
                $(this).wrap(element);
            });
        }</script><script>function loadComment() {
            let e, i;
            (e = document.createElement("script")).src = 'https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js',
            document.body.appendChild(e);
            e.onload = () => {
                var gitalk = new Gitalk({
                    clientID: 'b2fd920dada050fed5b3',
                    clientSecret: '5c847cefe7df2df634886eafa178877899404378',
                    repo: 'WhaleFell.github.io',
                    owner: 'WhaleFell',
                    admin: 'WhaleFell',
                    id: window.location.pathname,
                    distractionFreeMode: false
                });
                gitalk.render('gitalk-container');
            };
            (i = document.createElement("link")).rel = "stylesheet",
            i.href = 'https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css',
            document.head.appendChild(i);
        }
    
        var runningOnBrowser = typeof window !== "undefined";
        var isBot = runningOnBrowser && !("onscroll" in window) || typeof navigator !== "undefined" && /(gle|ing|ro|msn)bot|crawl|spider|yand|duckgo/i.test(navigator.userAgent);
        var supportsIntersectionObserver = runningOnBrowser && "IntersectionObserver" in window;
    
        setTimeout(function () {
            if (!isBot && supportsIntersectionObserver) {
                var comment_observer = new IntersectionObserver(function(entries) {
                    if (entries[0].isIntersecting) {
                        loadComment();
                        comment_observer.disconnect();
                    }
                }, { threshold: [0] });
                comment_observer.observe(document.getElementById('comment'));
            } else {
                loadComment();
            }
        }, 1);</script></body></html>